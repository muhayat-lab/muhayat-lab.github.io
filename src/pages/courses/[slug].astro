---
import Base from '../../layouts/BaseLayout.astro';
import Nav from '../../components/Nav.astro';
import Footer from '../../components/Footer.astro'];
import { getCollection } from 'astro:content';
const { slug } = Astro.params;
const course = (await getCollection('courses')).find(c => c.slug === slug);
if (!course) throw new Error('Course not found');
---
<Base title={`${course.data.title} — Muhayat Techlabs`}>
  <Nav />
  <main class="max-w-4xl mx-auto px-4 py-10">
    <h1 class="text-2xl md:text-3xl font-extrabold tracking-tight text-gray-900">{course.data.title}</h1>
    {course.data.code && <p class="text-xs text-gray-500 mt-1">{course.data.code}</p>}
    {course.data.description && <p class="text-sm text-gray-600 mt-2">{course.data.description}</p>}

    <section class="mt-8">
      <h2 class="text-lg font-semibold text-gray-900">Sessions</h2>
      <ol class="mt-3 grid gap-4">
        {course.data.sessions?.map(s => (
          <li class="rounded-2xl ring-1 ring-gray-200/60 bg-white p-4 shadow-sm">
            <h3 class="font-semibold text-gray-900">Week {s.week}: {s.title}</h3>
            {s.files.length > 0 && (
              <div class="mt-2">
                <p class="text-sm font-medium text-gray-700">Files:</p>
                <ul class="text-sm list-disc pl-5">
                  {s.files.map(f => (
                    <li><a class="text-emerald-700 hover:underline" href={f.url} target="_blank" rel="noopener">{f.name}</a>{f.size && ` — ${f.size}`}</li>
                  ))}
                </ul>
              </div>
            )}
            {s.reading.length > 0 && (
              <div class="mt-2">
                <p class="text-sm font-medium text-gray-700">Reading:</p>
                <ul class="text-sm list-disc pl-5">
                  {s.reading.map(r => (
                    <li><a class="text-emerald-700 hover:underline" href={r.url} target="_blank" rel="noopener">{r.title}</a></li>
                  ))}
                </ul>
              </div>
            )}
          </li>
        ))}
      </ol>
    </section>
  </main>
  <Footer />
</Base>
