---
import "../styles/global.css";
---

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Muhayat Techlabs</title>
  </head>
  <body class="antialiased bg-white text-gray-800">
    <!-- Header -->
    <header class="fixed top-0 left-0 right-0 z-50 bg-white shadow-sm">
      <div class="mx-auto flex max-w-7xl items-center justify-between px-4 py-3">
        <!-- Logo -->
        <a href="/" class="flex items-center space-x-2">
          <img
            src="/public/MuhayatDuduk1.png"
            alt="Logo"
            class="h-10 w-10 rounded-full border border-gray-300 object-cover"
          />
          <span class="text-lg font-bold text-emerald-700">Muhayat Techlabs</span>
        </a>

        <!-- Desktop Nav -->
        <nav class="hidden md:flex space-x-6 text-sm font-medium">
          <a href="/" class="hover:text-emerald-600">Home</a>
          <a href="/#courses" class="hover:text-emerald-600">Courses</a>
          <a href="/#articles" class="hover:text-emerald-600">Articles</a>
          <a href="/#search" class="hover:text-emerald-600">Search</a>
          <a href="/#about" class="hover:text-emerald-600">About</a>
        </nav>

        <!-- Mobile burger -->
        <button
          id="openDrawer"
          class="md:hidden p-2 rounded-lg hover:bg-gray-50"
          aria-label="Open menu"
        >
          <svg viewBox="0 0 24 24" class="h-6 w-6 text-gray-700">
            <path
              d="M4 6h16M4 12h16M4 18h16"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
            />
          </svg>
        </button>
      </div>
    </header>

    <!-- Overlay -->
    <div
      id="drawerOverlay"
      class="fixed inset-0 z-40 hidden bg-black/50 transition-opacity"
    ></div>

    <!-- Mobile Drawer -->
    <aside
      id="siteDrawer"
      class="fixed top-0 right-0 z-50 h-full w-64 translate-x-full transform bg-white shadow-lg transition-transform"
    >
      <div class="flex items-center justify-between border-b px-4 py-3">
        <a href="/" class="flex items-center space-x-2">
          <img
            src="/public/MuhayatDuduk1.png"
            alt="Logo"
            class="h-10 w-10 rounded-full border border-gray-300 object-cover"
          />
          <span class="font-bold text-emerald-700">Muhayat Techlabs</span>
        </a>
        <!-- ✅ Perubahan 1: tambah data-close-drawer -->
        <button
          id="closeDrawer"
          data-close-drawer
          class="p-2 rounded-lg hover:bg-gray-50"
          aria-label="Close menu"
        >
          <svg
            data-close-drawer
            viewBox="0 0 24 24"
            class="h-6 w-6 text-gray-700"
          >
            <path
              d="M6 6l12 12M18 6L6 18"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
            />
          </svg>
        </button>
      </div>
      <nav class="flex flex-col space-y-4 p-4 text-sm font-medium">
        <a href="/" class="drawer-link hover:text-emerald-600">Home</a>
        <a href="/#courses" class="drawer-link hover:text-emerald-600">Courses</a>
        <a href="/#articles" class="drawer-link hover:text-emerald-600">Articles</a>
        <a href="/#search" class="drawer-link hover:text-emerald-600">Search</a>
        <a href="/#about" class="drawer-link hover:text-emerald-600">About</a>
      </nav>
      <footer class="mt-auto border-t p-4 text-xs text-gray-500">
        © 2025 Muhayat Techlabs
      </footer>
    </aside>

    <!-- Main content -->
    <main class="pt-20">
      <slot />
    </main>

    <!-- ✅ Perubahan 2: script drawer event delegation -->
    <script>
      (function () {
        const root = document.documentElement;
        const openBtn = document.getElementById("openDrawer");
        const overlay = document.getElementById("drawerOverlay");
        const drawer = document.getElementById("siteDrawer");

        function openDrawer() {
          root.classList.add("drawer-open");
          overlay.classList.remove("hidden");
          openBtn?.setAttribute("aria-expanded", "true");
        }
        function closeDrawer() {
          root.classList.remove("drawer-open");
          overlay.classList.add("hidden");
          openBtn?.setAttribute("aria-expanded", "false");
        }

        // delegasi klik untuk tombol close
        document.addEventListener("click", (e) => {
          const el = e.target;
          if (el && el.closest?.("[data-close-drawer]")) {
            closeDrawer();
          }
        });

        openBtn?.addEventListener("click", openDrawer);
        overlay?.addEventListener("click", closeDrawer);

        document.addEventListener("keydown", (e) => {
          if (e.key === "Escape") closeDrawer();
        });

        document.querySelectorAll(".drawer-link").forEach((a) => {
          a.addEventListener("click", closeDrawer);
        });

        drawer?.addEventListener("click", (e) => e.stopPropagation());
      })();
    </script>
  </body>
</html>