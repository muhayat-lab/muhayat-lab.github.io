---
interface Props {
  title?: string;
  description?: string;
  /** Aktifkan tipografi .prose untuk artikel (Markdown). Default: false */
  prose?: boolean;
  /** Lebar container: 'narrow' (artikel) | 'wide' (halaman biasa). Default otomatis dari 'prose' */
  container?: 'narrow' | 'wide';
}

const {
  title = "Muhayat Techlabs",
  description = "Website pribadi dosen: materi kuliah, artikel, dan inspirasi menarik di bidang Teknologi Informasi.",
  prose = false,
  container = prose ? 'narrow' : 'wide',
} = Astro.props;

import Header from "../components/Header.astro";
import "../styles/global.css";

const containerClass =
  container === 'narrow'
    ? "mx-auto max-w-3xl px-4 sm:px-6 lg:px-8"
    : "mx-auto max-w-6xl px-4 sm:px-6 lg:px-8";
---

<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={description} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/og.png" />
    <style>
      :root{
        --brand:#1C8139; --brand-600:#0b7b61; --brand-700:#096e58;
      }
      /* Offset scroll utk heading saat ada navbar fixed */
      .md-content :where(h1,h2,h3,h4){scroll-margin-top:96px;}
    </style>
  </head>

  <body class="text-gray-900 antialiased">
    <!-- HEADER -->
    <Header />

    <!-- MAIN -->
    <main id="content" class={`md-content ${containerClass}`}>
      {
        prose
          ? (
            /* MODE ARTIKEL: tipografi .prose + lebar sempit */
            <article class="prose prose-lg prose-headings:font-semibold prose-a:text-[var(--brand-700)] hover:prose-a:text-[var(--brand-600)]">
              <slot />
            </article>
          )
          : (
            /* MODE HALAMAN BIASA (Home, dst): bebas, lebar wide */
            <div>
              <slot />
            </div>
          )
      }
    </main>

    <!-- FOOTER -->
    <footer class="mt-20 text-white">
      <div class="bg-gradient-to-r from-[var(--brand)] to-black">
        <div class="mx-auto max-w-6xl px-4 sm:px-6 py-5">
          <div class="border-t border-white/10 pt-4 text-sm text-white/70">
            © {new Date().getFullYear()} Muhayat Techlabs. All rights reserved.
          </div>
        </div>
      </div>
    </footer>

    <!-- Drawer & overlay (tetap) -->
    <div id="drawerOverlay" class="fixed inset-0 z-[60] hidden bg-black/30"></div>
    <aside id="siteDrawer"
      class="fixed top-0 right-0 z-[70] h-screen w-72 bg-white shadow-xl border-l border-gray-100
             p-5 flex flex-col gap-2 translate-x-full will-change-transform"
      role="dialog" aria-modal="true" aria-labelledby="drawerTitle">
      <div class="flex items-center justify-between mb-4">
        <div class="flex items-center gap-3">
          <img src="/muhayat.png" alt="Muhayat Techlabs" class="h-10 w-10 rounded-full ring-2 ring-[var(--brand)]/25"/>
          <span id="drawerTitle" class="font-bold" style="color:var(--brand)">Muhayat Techlabs</span>
        </div>
        <button id="closeDrawer" class="p-2 rounded-lg hover:bg-gray-50" aria-label="Close menu">
          <svg viewBox="0 0 24 24" class="h-6 w-6 text-gray-700">
            <path d="M6 6l12 12M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>

      <a href="/" class="py-2 px-3 rounded-md hover:bg-gray-50 text-gray-800 drawer-link">Home</a>
      <a href="/courses" class="py-2 px-3 rounded-md hover:bg-gray-50 text-gray-800 drawer-link">Courses</a>
      <a href="/articles" class="py-2 px-3 rounded-md hover:bg-gray-50 text-gray-800 drawer-link">Articles</a>
      <a href="/search" class="py-2 px-3 rounded-md hover:bg-gray-50 text-gray-800 drawer-link">Search</a>
      <a href="/about" class="py-2 px-3 rounded-md hover:bg-gray-50 text-gray-800 drawer-link">About</a>

      <div class="mt-auto pt-4 text-xs text-gray-500">
        © {new Date().getFullYear()} Muhayat Techlabs
      </div>
    </aside>

    <style is:global>
      #siteDrawer{transition:transform .28s ease;}
      .drawer-open #siteDrawer{transform:translateX(0);}
      .drawer-open #drawerOverlay{display:block;}
      .drawer-open body{overflow:hidden;}
    </style>

    <script>
      (function(){
        const root=document.documentElement;
        const openBtn=document.getElementById('openDrawer');
        const closeBtn=document.getElementById('closeDrawer');
        const overlay=document.getElementById('drawerOverlay');
        const drawer=document.getElementById('siteDrawer');

        function openDrawer(){root.classList.add('drawer-open');openBtn?.setAttribute('aria-expanded','true');}
        function closeDrawer(){root.classList.remove('drawer-open');openBtn?.setAttribute('aria-expanded','false');}

        openBtn?.addEventListener('click',openDrawer);
        closeBtn?.addEventListener('click',closeDrawer);
        overlay?.addEventListener('click',closeDrawer);
        document.addEventListener('keydown',e=>{if(e.key==='Escape') closeDrawer();});
        document.querySelectorAll('.drawer-link').forEach(a=>a.addEventListener('click',closeDrawer));
        drawer?.addEventListener('click',e=>e.stopPropagation(),true);
      })();
    </script>
  </body>
</html>
